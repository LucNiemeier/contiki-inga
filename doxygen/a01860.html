<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Contiki-Inga 3.x: Master SPI Bus Manager</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Contiki-Inga 3.x
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Master SPI Bus Manager<div class="ingroups"><a class="el" href="a01844.html">Bus Drivers</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga9d32c9f4e55b9c60d0f565e04a732fc3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01860.html#ga9d32c9f4e55b9c60d0f565e04a732fc3">MAX_SPI_DEVICES</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:ga9d32c9f4e55b9c60d0f565e04a732fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1c56d3bf4459b71b23b1a19cfcc00756"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01860.html#ga1c56d3bf4459b71b23b1a19cfcc00756">mspi_mgr_add</a> (uint8_t cs, uint8_t mode, uint16_t baud)</td></tr>
<tr class="memdesc:ga1c56d3bf4459b71b23b1a19cfcc00756"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function add a device to the SPI device table and calculates the specific checksum.  <a href="#ga1c56d3bf4459b71b23b1a19cfcc00756">More...</a><br/></td></tr>
<tr class="separator:ga1c56d3bf4459b71b23b1a19cfcc00756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c76b1450fd34e103155a69e1cf75b87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01860.html#ga4c76b1450fd34e103155a69e1cf75b87">mspi_mgr_change_mode</a> (spi_dev new_config)</td></tr>
<tr class="memdesc:ga4c76b1450fd34e103155a69e1cf75b87"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function changes the SPI configuration.  <a href="#ga4c76b1450fd34e103155a69e1cf75b87">More...</a><br/></td></tr>
<tr class="separator:ga4c76b1450fd34e103155a69e1cf75b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The various SPI devices are all connected to the SPI Bus (SCK, MOSI/SDA, MISO/SDI) and only separated by the Chip Select. With a high probability, not every SPI Device will use the same SPI Bus configuration (SPI Mode), so you would have to change (or to check) the SPI mode whenever accessing another SPI device. But in higher software layers you are not interested in such details like SPI Mode. Therefore the SPI Bus Manager was implemented, to separate the low level hardware and register level from higher software layers. The SPI Bus Manager holds all devices, which are connected to the SPI Bus. With a checksum he can decide, if the SPI configuration has to change. So in some cases these reconfiguration can be avoid.</p>
<dl class="section note"><dt>Note</dt><dd>If you know what you are doing, it is possible to disable the SPI Bus Manager by setting MSPI_BUS_MANAGER in the mspi-drv.h to 0. </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga9d32c9f4e55b9c60d0f565e04a732fc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SPI_DEVICES&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defines the maximum number of SPI devices </p>
<dl class="section note"><dt>Note</dt><dd>In our case we have 7 (2Â³-1) possible SPI devices, because we are using 3 I/O pins and a BCD-to-decimal encoder for the chip select. </dd></dl>

<p>Definition at line <a class="el" href="a01490_source.html#l00070">70</a> of file <a class="el" href="a01490_source.html">mspi-mgr.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga1c56d3bf4459b71b23b1a19cfcc00756"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspi_mgr_add </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>baud</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function add a device to the SPI device table and calculates the specific checksum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs</td><td>Chip Select: Device ID </td></tr>
    <tr><td class="paramname">mode</td><td>Select the (M)SPI mode (MSPI_MODE_0 ... MSPI_MODE_3) </td></tr>
    <tr><td class="paramname">baud</td><td>The MSPI BAUD rate. Sometimes it is necessary to reduce the SCK. Use MSPI_BAUD_MAX in common case. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a01491_source.html#l00187">187</a> of file <a class="el" href="a01491_source.html">mspi.c</a>.</p>

<p>Referenced by <a class="el" href="a01491_source.html#l00109">mspi_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4c76b1450fd34e103155a69e1cf75b87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mspi_mgr_change_mode </td>
          <td>(</td>
          <td class="paramtype">spi_dev&#160;</td>
          <td class="paramname"><em>new_config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function changes the SPI configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi_dev</td><td>The specified entry of the SPI Device Table </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a01491_source.html#l00195">195</a> of file <a class="el" href="a01491_source.html">mspi.c</a>.</p>

<p>Referenced by <a class="el" href="a01491_source.html#l00131">mspi_chip_select()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 24 2014 16:26:19 for Contiki-Inga 3.x by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
